{% extends "base.html" %}

{% block title %}AIå•é¡Œç”Ÿæˆ - ä¸ƒå¤¢å­¦ç¿’ã‚¢ãƒ—ãƒª{% endblock %}

{% block content %}
<div class="page-header">
    <h1 class="page-title">âœ¨ AIå•é¡Œä¸€æ‹¬ç”Ÿæˆ</h1>
    <a href="{{ url_for('dashboard') }}" class="btn btn-secondary btn-sm">â† æˆ»ã‚‹</a>
</div>

<div class="card">
    <p>AIã‚’ä½¿ã£ã¦æ—¥æœ¬èªå­¦ç¿’ç”¨ã®ç†Ÿèªã‚¯ã‚¤ã‚ºã‚’ä¸€æ‹¬ç”Ÿæˆã—ã¾ã™ã€‚ç”Ÿæˆã•ã‚ŒãŸå•é¡Œã¯ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã«ä¿å­˜ã•ã‚Œã€ç”Ÿå¾’ãŒã™ãã«ä½¿ãˆã‚‹ã‚ˆã†ã«ãªã‚Šã¾ã™ã€‚</p>

    <form method="POST" id="generate-form">
        <div class="form-group">
            <label class="form-label">é›£æ˜“åº¦</label>
            <div style="display: flex; gap: 12px;">
                <label style="display: flex; align-items: center; gap: 6px; cursor: pointer;">
                    <input type="radio" name="difficulty" value="easy" checked> ğŸŒ± ã‹ã‚“ãŸã‚“ (N5)
                </label>
                <label style="display: flex; align-items: center; gap: 6px; cursor: pointer;">
                    <input type="radio" name="difficulty" value="medium"> ğŸŒ¿ ãµã¤ã† (N4)
                </label>
                <label style="display: flex; align-items: center; gap: 6px; cursor: pointer;">
                    <input type="radio" name="difficulty" value="hard"> ğŸŒ³ ã‚€ãšã‹ã—ã„ (N3)
                </label>
            </div>
        </div>

        <div class="form-group">
            <label class="form-label" for="count">ç”Ÿæˆã™ã‚‹å•é¡Œæ•°</label>
            <select name="count" id="count" class="form-input">
                <option value="3">3å•</option>
                <option value="5" selected>5å•</option>
                <option value="10">10å•</option>
            </select>
        </div>

        <div class="form-group">
            <label class="form-label" for="theme">ãƒ†ãƒ¼ãƒï¼ˆä»»æ„ï¼‰</label>
            <input type="text" name="theme" id="theme" class="form-input" placeholder="ä¾‹: å­¦æ ¡ã€é£Ÿã¹ç‰©ã€å‹•ç‰©ãªã©">
        </div>

        <button type="submit" class="btn btn-primary btn-block" id="submit-btn">
            âœ¨ AIã§å•é¡Œã‚’ç”Ÿæˆ
        </button>
    </form>
</div>

{% if generated_problems %}
<div class="card">
    <h2 class="card-title">ğŸ“‹ ç”Ÿæˆã•ã‚ŒãŸå•é¡Œ ({{ generated_problems|length }}å•)</h2>

    {% for prob in generated_problems %}
    <div style="padding: 12px; background: var(--bg-hover); border-radius: 8px; margin-bottom: 12px;">
        <div style="display: flex; justify-content: space-between; align-items: center;">
            <div>
                <strong style="font-size: 1.3rem;">{{ prob.word }}</strong>
                <span style="color: var(--text-muted);">ï¼ˆ{{ prob.correct_reading }}ï¼‰</span>
            </div>
            <span style="color: #4caf50;">âœ… ä¿å­˜æ¸ˆã¿</span>
        </div>
        <div style="margin-top: 6px; font-size: 0.9rem; color: var(--text-secondary);">
            ğŸ‡¨ğŸ‡³ {{ prob.meaning_chinese }}
        </div>
        <div style="margin-top: 4px; font-size: 0.85rem; color: var(--text-muted);">
            ğŸ“ {{ prob.example }}
        </div>
    </div>
    {% endfor %}

    <a href="{{ url_for('teacher_japanese_problems') }}" class="btn btn-secondary btn-block">
        ğŸ“‹ ã™ã¹ã¦ã®å•é¡Œã‚’ç®¡ç†
    </a>
</div>
{% endif %}

{% if error %}
<div class="alert alert-error">
    {{ error }}
</div>
{% endif %}

<!-- ç¾åœ¨ã®å•é¡Œæ•° -->
<div class="card">
    <h2 class="card-title">ğŸ“Š å•é¡Œçµ±è¨ˆ</h2>
    <div style="display: grid; grid-template-columns: repeat(2, 1fr); gap: 12px;">
        <div class="stat-card">
            <div class="stat-icon">ğŸ“š</div>
            <div class="stat-value">{{ total_problems }}</div>
            <div class="stat-label">ç™»éŒ²æ¸ˆã¿å•é¡Œæ•°</div>
        </div>
        <a href="{{ url_for('teacher_japanese_problems') }}" class="stat-card"
            style="text-decoration: none; cursor: pointer;">
            <div class="stat-icon" style="background: var(--secondary);">âš™ï¸</div>
            <div class="stat-value">ç®¡ç†</div>
            <div class="stat-label">å•é¡Œã‚’ç®¡ç†ã™ã‚‹</div>
        </a>
    </div>
</div>

<script>
    document.getElementById('generate-form').addEventListener('submit', function () {
        const btn = document.getElementById('submit-btn');
        btn.disabled = true;
        btn.innerHTML = 'â³ AIãŒå•é¡Œã‚’ç”Ÿæˆä¸­...ï¼ˆã—ã°ã‚‰ããŠå¾…ã¡ãã ã•ã„ï¼‰';
    });
</script>
{% endblock %}